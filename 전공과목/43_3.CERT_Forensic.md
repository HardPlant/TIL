# 침입사고 대응과 포렌식

## 컴퓨터 침해사고

고의적이고 나쁜 의도의 기술적 행위들로 인해 발생하는 사건들에 대해 전문지식을 가지고 대처
피해를 복구, 억제하며 앞으로 발생할 피해 방지

보안사고는 널리 알려져 있음에도 불구하고 보안사고의 발생은 예측할 수 없음
처음 직면할 떄에는 임시방편적으로 대응할 수 있으나 비슷한 사고의 재발에는 신속한 복구와 대응 가능
사고처리는 빠르고 효과적인 대응 능력을 필요로 하기 때문에 비상계획의 한 요소로 검토될 수 있음

## 컴퓨터 침해 대응팀(CERT)

컴퓨터 응급 대응센터, 1988년 웜에 의한 대대적인 피해 후 창설

### CERT의 역할

침해사고 예방/대응, 기술연구 및 전파
취약점 진단 및 조치, 모니터링, 교육 등 침해사고 예방 활동
침해사고 접수, 분석, 피해복구 등 침해사고 대응 활동
KrCERT/CC등 외부기관의 대응협력 활동

예방, 탐지, 교정 통제 제공
정보보안 관련 모든 사고와 현안에 대한 Single contact point

### 사고대응 7단계 절차

* 사고 전 준비 과정

    침해사고 대응팀, 조직적 대응 준비

* 사고 탐지

    정보보호/네트워크 장비에 의한 이상 징후 탐지
    관리자에 의한 침해 사고 식별

* 초기 대응

    초기 조사 수행, 사고 정황에 대한 기본적인 세부사항 기록, 사고대응팁 신고 및 소집, 침해사고 관련 부서에 통지

* 대응 전략 체계화

    최적의 전략 결정, 관리자 승인 획득
    초기 조사 결과를 참고해 소송이 필요한 사항인지 결정
    사고 조사 과정에 수사기관 공조 여부 판단

* 사고 조사

    데이터 수집 및 분석을 통해 수행
    언제, 누가, 어떻게 사고가 일어났는지, 피해 확산 및 사고 재발을 어떻게 방지할 것인지 결정

* 보고서 작성

    의사결정자가 쉽게 이해할 수 있는 형태로 사고에 대한 정확한 보고서 작성

* 해결

    차기 유사 공격을 식별 및 예방하기 위한 보안 정책 수립, 절차 변경, 사건의 기록, 장기 보안 정책 수립, 기술 수정 계획수립 등 결정

* CERT가 하지 말아야 할 일들

    개개인에 대한 조사
    해결책 없이 취약점 관련 정보 전달
    승인 없이 사이트 명과 담당자 연락처 공개
    승인 없이 사법당국에 정보 전달
    관할지역 구성원들의 문제 수정 (조언은 가능)

## 컴퓨터 포렌식

하드디스크 등 컴퓨터 저장매체에 들어 있는 데이터를 대상으로 복구, 검색, 수사하는 기법
법원이 인정할 만한 컴퓨터 관련 증거를 수집, 보존, 분석해 법원에 제출, 결정적인 증거로 활용

## 기본 원칙

증거를 발견, 기록, 획득, 보관하는 절차가 적절해야 한다.

* 정당성의 원칙

    모든 증거는 적법한 절차는 거쳐서 획득한 것이어야 한다.

* 재현의 원칙

    증거는 어떤 절차를 통해 정제되는 과정을 거칠 수 있다. (삭제/손상 파일 복구)
    증거는 똑같은 환경에서 같은 결과가 나오도록 재현할 수 있어야 한다.

* 신속성의 원칙

    컴퓨터 내부 정보는 휘발성을 가진 것이 많기 때문에 신속하게 이루어져야 한다.

* 연계 보관성의 원칙

    이송/분석/보관/법정 제출이라는 일련의 과정이 명확해야 하며, 이러한 과정에 대한 추적이 가능해야 한다.
    이를 연계 보관성이라 한다.

    연계 보관성을 만족하려면 증거를 전달하고 전달받는 데 관여한 담당자와 책임자를 명시해야 한다.

    | 인계자 | 인수자 | 증거 보간 위치 변동사항 | 날짜 | 인계 내용 및 이유 |
    |-------|--------|-----------------------|------|-----------------|
    |이름:(서명)|이름:(서명)|()=====>() |   |   |
    |이름:(서명)|이름:(서명)|()=====>() |   |   |
    |이름:(서명)|이름:(서명)|()=====>() |   |   |

    (연계보관성 로그표)

* 무결성의 원칙

    수집된 정보는 연계 보관성을 만족시켜야 하고, 각 단계를 거치는 과정에서 위조 및 변조되어서는 안되며, 이러한 사항을 매번 확인해야 한다.
    하드디스크 같은 경우 해시값을 구해 각 단계마다 그 값을 확인해 무결성을 입증할 수 있다.

## 포렌식 수행 절차

### 수사 준비

사이버 포렌식을 수행하는 전ㄴ문가를 소집하고 각종 장비, 소프트웨어, 하드웨어를 준비하고 점검한다.

### 증거물 획득(증거 수집)

불법행위가 발생한 장소에서 네트워크 시스템/행위자가 사용한 컴퓨터를 압수해 각종 저장매체로부터 디지털 증거를 획득한다.
디지털 증거를 단계에서는 증거의 무결성이 매우 중요하다. 파일을 열어 마지막 접근시간이 변경된다면 불법행위 당시에 문서가 작성되었다는 것을 증명하기가 불가능하다.
하드디스크 같은 저장매체에 저장된 데이터를 추출하는 과정을 디스크 이미징이라고 한다.
디스크 복사와 달리 디스크 내에 있는 숨김/임시파일, 손상/삭제파일 등의 잔여정보가 그대로 존재하는 동일한 사본을 만든다.

### 보관 및 이송

획득한 증거는 연계 보관성을 만족시키며 보관 및 이송(preservation)되어야 한다.
보관은 안전한 장소(Evidence sage)에 하여야 한다.
이송되거가 담당자/책임자가 바뀔 때는 문서에 그 증적을 남긴다.

### 조사 및 분석

포렌식 관련 증거를 관리할 떄에는 최량 증거 원칙(원본으로 내용을 증명)해야 한다.
획득한 디지털 증거물을 조사하고 분석하는 단계로서 디스크 브라우징, 데이터 뷰, 파일 복구 등 다양한 기법들이 활용되고 있다.
확인과정에서 불법행위의 증거가 발견되면 원본 데이터의 무결성을 유지시키면서 데이터 확인과정을 문서화해야 한다.

* 디스크 브라우징

    저장 매체/디스크 이미지에 존재하는 파일들을 GUI 환경에서 쉽고 편리하게 다룰 수 있도록 기억장치에 저장된 이진 데이터를 폴더/파일 단위로 출력하는 등 수집한 저장 매체, 디스크 이미지 내부에 있는 정보를 가독성 있는 형태로 변환해 출력한다.

* 데이터 뷰

    저장 매체, 디스크에 저장된 방대한 파일을 열어서 확인할 수 없기 떄문에 브라우징 과정에서 파일을 인식, 텍스트/그림 등의 형식으로 볼 수 있도록 하는 자동 뷰 기능을 제공한다.

* 파일 복구

    복구 소프트웨어를 이용해 파일 원본을 복구시킨다. 파일이 손상/삭제되더라도 디스크 내에는 관련 정보가 보존되어 있기 때문에 파일 복구가 가능하다.

### 보고서 작성

포렌식의 모든 단계의 내용을 문서화한다.
일련의 과정을 정확히 작성하여 증거자료로서 타당성을 제공해야 한다.

증거자료 획득, 보관 및 이송, 분석 등 모든 과정을 명확하고 객관성 있게 설명하고 불법행위를 입증할 수 있도록 논리적으로 작성해야 한다.

### 포렌식 기술

* 디스크 포렌식

    물리적 저장장치에서 증거 수집/분석

* 시스템 포렌식

    운영체제, App 및 프로세스 등을 분석

* 네트워크 포렌식

    네트워크로 전송되는 데이터/암호 등을 특정 도구를 이용해 가로채거나 서버에 저장된 로그파일에 접근하여 분석,
    에러로그, 네트워크 형태등을 조사해 단서를 찾아내는 기술

* 인터넷 포렌식

    웹 등 인터넷 App 프로토콜을 사용하는 분야에서 증거 수집

* 모바일 포렌식

    휴대폰, USB 등 휴대용 전자 기기에서 필요한 정보를 입수

* 데이터베이스 포렌식

    DB에서 데이터를 추출, 분석해 증거를 수집

* 암호 포렌식

    문서나 시스템에서 암호를 찾아내 암호화 문서를 복호화

### 역할

* 1차 대응자

컴퓨터를 보호하는 것 이외에는 어떠한 행동도 해서는 안된다.

* 수사자

수사자/수사팀은 범죄현장에서 일어나는 다른 모든 일을 조정할 책임을 가진다.

* 범죄 현장 기술자

컴퓨터 포렌식에 관한 특수한 교육을 받아야 한다.
컴퓨터 기술에 대한 강력한 배경 지식을 갖고 있어야 하며 디스크의 구조는 어떻게 되는지, 파일시스템은 어떻게 동작하는지, 데이터가 어디에 그리고 어떻게 기록되는지를 이해해야 한다.

## 증거

범죄 수사자는 각 지역의 증거 관련법에 익숙해져야 한다.

### 증거 규칙

* 관련성

    관련 범죄의 실제적인 사실을 입승할 수 있어야 한다.
    증거가 범죄의 시간, 원인 등을 밝힐 수 있을 정도로 범죄와 관련이 있어야 한다.

* 신뢰성

    증거에 대한 신뢰성, 증거를 얻기까지의 과정의 신뢰성을 입증할 수 있어야 한다.
    손상이나 변형 없이 적절한 조치 하에 식별되어야 한다.

* 충분성

    다른 어느 누구도 증거를 보고 반론할 수 없도록 증거가 설득력이 있어야 한다.

* 법적 허용성

    비합법적으로 입수된 증거는 법원에 증거로 받아들여질 수 없다.

### 증거 꼬리표 달기와 표식 남기기

* 증거를 맨 처음 보관하기 시작한 사람은 증거에 꼬리표를 달거나 표식을 남겨야 한다.
    증거에 자신의 이름, 날짜와 시간, 사건 번호를 적어야 한다.

* 가능하면 물리적으로 증거물에 표식을 남겨 두는 것이 좋다. 꼬리표는 증거물에서 쉽게 떼어낼 수 있는데, 그러면 증거 담당자 목록이 잘 유지되지 않는다.

### 보호관리 사슬(Chain of Custody)

증거 담당자 목록은 증거의 연속성을 가리킨다.
현장에서 수집된 증거가 법정에 체줄될 때까지 거쳐간 경로, 그 증거를 다룬 모든 사람, 증거가 옮겨진 장소와 시간을 추적할 수 있어야 한다.
증거 담당자 목록을 문서화하는 것은 증거 기록을 남기는 가장 중요한 목적의 하나이다.

### 디지털 증거물 분석

* Timeline 분석 : 파일 생성, 변경, 접근, 삭제시간 등

* 시그니쳐 분석 : 의도적으로 파일 확장자를 변경해 놓은 파일을 간단히 파악

* Hash 분석 : 시스템 내의 파일이 변경되었는가를 확인, 기존에 알려진 파일과 같은 파일이 존재하는가를 확인

* 로그 분석 : 웹 브라우저 로그, 메일 로그, FTP 로그 등

* 프로세스 분석 : 현재 수행되고 있는 프로세스의 메모리 내용 조사, 의심되는 실행 파일 조사

### 사라지기 쉬운 데이터 보존

시스템의 메모리(RAM, Cache, 그래픽카드 및 NIC 등의 온보드 메모리 포함)에 임시로 저장된 데이터를 휘발성 데이터라고 부른다.

### 디지털 증거 보존

디지털 증거는 근본적으로 손상되기 쉽다.
디지털 증거를 보호하는 첫 번째 단계는 조작/사고가 일어나지 않도록 보호하는 것이다.
가장 좋은 방법은 증거가 저장된 매체의 완전한 비트스트림 이미지를 즉시 만드는 것이다. (모든 데이터의 사본)

디스크 복사 : 파일/디렉터리 단위 정보(Source Read & Destination Write)
디스크 이미징 : 디스크의 모든 물리적 섹터, Bit Stream Clone(Sector by Sector)

## 디지털 증거 복구

데이터 삭제, 포맷/파티셔닝, 데이터가 있을 만한 곳이 아닌 곳에 데이터를 숨긴다.

### 삭제된 데이터 복구

파일을 지우는 것은 FAT/MFT 등 디스크 파일 위치를 기록하기 위해 사용하는 데이터 구조에서 항목 하나를 없애는 것에 불과하다.

### 감춰진 데이터 찾기

데이터 중 일부는 파일이 삭제되거나 디스크가 다시 파티션될 때 남아있던 주변 데이터이다.
기술을 잘 아는 사이버 범죄자가 디스크 편집기, 스테가노그래피, 소프트웨어 등 고의적으로 데이터를 숨길 수 있는 여러 장소가 존재한다.
이러한 숨겨진 데이터를 찾아 꺼낸 다음 재구성하는 작업은 매우 지루한 작업이긴 하지만 사견해결의 실마리가 될 정도로 중요하다.

데이터는 Sector gap(외부 트랙 부분에 쓰지 않는 저장 공간), Slack Area(클러스터와 파일크기가 서로 다르기 때문에 발생하는 공간)에 주로 숨길 수 있다.

### 잊혀진 데이터 찾기



### 임시 파일