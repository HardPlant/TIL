# Firewall Type and Structure

## 유형

### 패킷 필터링 방화벽

규칙모음에 따라 패킷을 전달하거나 폐기

[Interface : Source IP : Source Port : Dest IP : Dest Port]

* 장점

  확장 가능
  빠르고 단순함
  응용프로그램에 독립적

* 약점

  상위계층 데이터를 검사하지 않음 (취약점, 기능 이용 공격 방어 불가능)
  접근제어 변수가 적어 구성을 잘못하게 되면 보안에 허점이 생김
  연결상태를 추적하지 않음

#### 공격과 대응 방법

* IP Spoofing

  가짜 주소를 보내 내부 네트워크의 특정 패킷을 허용하는 규칙을 이용하는 공격이다

  Router에서 Source routing을 허용하지 않음 (외부에 들어오는 내부망 IP 패킷을 차단)
  Seq Number를 Random하게 만듬
  DoS 취약성 제거 (IP Spoofing은 DoS 공격의 시작)
  IP로 인증하는 서비스를 사용하지 않음
  암호화된 프로토콜 사용

* Source routing

  패킷의 발신지 경로매칭 정보를 분석당하지 않도록 패킷에 인터넷이 따라가는 정보(Routing)을 지정한다

* Tiny fragment attack

  IP Fragment 옵션을 이용해 아주 작은 단편을 만들고 TCP헤더 정보를 별개의 따로 떨어진 패킷의 단편으로 만든다
  TCP 헤더 정보에 의존하는 필터링 규칙을 피해, 공격자는 필터링 라우터가 첫 번째 단편만 검사하고 나머지는 그냥 통과시키도록 의도한다

### Stateful Packet Inspection

TCP 분석 추가
TCP 순서번호를 추적해 세션하이재킹 공격 막음
상태정보 테이블 유지
네트워크, 전송 계층에서 동작함

#### 특징

* 모든 통신 채널을 추적하는 상태 테이블 관리

* UDP, ICMP 등 비연결지향 프로토콜을 추적하는 데이터 제공

* 패킷 안의 데이터 상태, 문맥 갱신 및 저장

#### 작동 원리

* SYN 패킷을 전송받으면 접근제어 정책 검토, 상태 테이블에 남김

* 접근 허용 패킷은 네트워크 계층으로 전송

* SYN 패킷이 아니면 상태 테이블의 패킷정보 여부 검사, 상테 테이블에 존재하지 않을 시 접근제어 정책 사용

#### 장단점

정보에 대한 보안성 높이기 가능
전체 계층에 대한 상태 조사 가능, 투명성 제공
연결 요쳥의 첫 패킷 헤더 공격당할 시 잘못된 상태 테이블 구성 가능

### NAT

사설 주소와 범용 주소의 매핑 제공

#### 주소 변환

NAT 라우터를 통해 나가는 모든 패킷은 Src 주소를 NAT 주소로 변환한다.

#### Static NAT : 하나의 IP 주소 사용

가장 간단한 형태, 변환 테이블이 [사설 주소 : 외부 주소]

#### Dynamic NAT : Ip 주소 풀 사용

하나의 외부 호스트에 하나의 사설 호스트만 접속할 수 있는 제한을 제거한다.
예) 4개의 주소 사용
[200.24.x.x, 20024.5.x, 200.24.5.x : 200.24.1.1]

#### Port Address Translation : IP 주소와 포트 주소 사용

다중 연결을 설정하기 위해 포트와 프로토콜을 조사한다.

[내부 주소, 내부 포트 : 외부 주소, 외부 포트 : 프로토콜]

### Proxy Firewall

## 배치

### Bastion Host

### Host-based

### Personal

## 위치와 구성

### Screening Router

### Dual-homed host

### Screened Gateway

### Screened Subnet