# multiple_org

[](https://github.com/hyperledger/fabric-sdk-go/blob/master/test/integration/e2e/orgs/multiple_orgs_test.go)

### 선언부

org1, 2, admin, user 정의

### Testmain

setup()
Run()
teardown()

### setup()

SDK 설정

```go
fabsdk.New()
org1MspClient = mspclient.New()
org2MspClient = mspclient.New()
```

### TestOrgsEndToEnd()

* loadOrgPeer()

* 컨텍스트 준비

```go
	mc := multiorgContext{
		ordererClientContext:   sdk.Context(fabsdk.WithUser(ordererAdminUser), fabsdk.WithOrg(ordererOrgName)),
		org1AdminClientContext: sdk.Context(fabsdk.WithUser(org1AdminUser), fabsdk.WithOrg(org1)),
		org2AdminClientContext: sdk.Context(fabsdk.WithUser(org2AdminUser), fabsdk.WithOrg(org2)),
		ccName:                 exampleCC, // basic multi orgs test uses exampleCC for testing
		ccVersion:              "0",
		channelID:              channelID,
	}
```

* 로컬 피어 디스커버리, 조직별
(integration은 테스트 패키지에 있음)
integration.DiscoverLocalPeers(mc.org1AdminClientContext)

setupClientContextsAndChannel(sdk, &mc)

createAndJoinChannel()

testWithOrg1()
testWithOrg2()

verifyWithOrg1()

* 같은 설정으로 다중조직 테스트

TestMultiOrgWithSingleOrgConfig()

* org당 1sdk로 조직 서명 완료

DistributedSignaturesTests

### loadOrgPeers(ctxProvider contextAPI.ClientProvier)

ctx = ctxProvider()

org1Peers = ctx.EndpointConfig().PeersConfig(org1)

org2Peers = ctx.EndpointConfig().PeersConfig(org2)

orgTestPeer0 = ctx.InfraProvider().CreatePeerFromConfig()

### setupClientContextAndChannel()

* 리소스 매니저 생성

org1RMgmt = resmgmt.New(org1AdminClientContext)
org2RMgmt = resmgmt.New(org2AdminClientContext)

mc.org1Rgmt = org1RMgmt
mc.org2Rgmt = org2RMgmt

### createAndJoinChannel(mc){
    
}